"use strict";!function(){$(function(){$.each($(".site__menu"),function(){new n($(this))}),$.each($(".language"),function(){new e($(this))})});var e=function(e){var n,o,i=e,s=$(".language__dropdown"),t=$(".language__item"),a=200,c=($(window),function(){t.on({click:function(e){$(this).parent().hasClass("language__active")&&(i.trigger("mouseenter"),e.preventDefault()),$(this).parent().hasClass("language__dropdown")&&($(".language__active .language__item").appendTo(s),$(this).appendTo(".language__active"),s.stop(!0,!0).slideUp(a))}}),i.on({mouseenter:function(){clearTimeout(o),n=setTimeout(function(){s.stop(!0,!0).slideDown(a)},200)}}),i.on({mouseleave:function(){clearTimeout(n),o=setTimeout(function(){s.is(":visible")&&s.stop(!0,!0).slideUp(a)},200)}})}),u=function(){c()};u()},n=function(e){var n=this,o=e,i=$("body"),s=$(window),t=$(".site__menu-btn"),a=function(){t.on({click:function(){u($(this))}}),s.on({resize:function(){l()},scroll:function(){c()}})},c=function(){var e=s.scrollTop(),n=$(".site__hero").innerHeight();e>n?t.hasClass("active")||t.addClass("active"):t.removeClass("active")},u=function(e){var n=e;n.hasClass("opened")?(n.removeClass("opened"),o.removeClass("opened"),i.css({overflow:"visible"})):(n.addClass("opened"),o.addClass("opened"),i.css({overflow:"hidden"}))},l=function(){t.removeClass("opened"),o.removeAttr("style"),i.css({overflow:"visible"})},r=function(){o[0].obj=n,a()};r()}}();
!function(){$(function(){$(".popup").each(function(){new o($(this))})});var o=function(o){var n=this,e=40,t=$(".popup__open"),i=o,p=i.find(".popup__close, .popup__cancel"),c=i.find(".popup__wrap"),u=i.find(".popup__content"),s=$("html"),a=$(window),d=$(".popup__video"),r=setTimeout(function(){},1),f=function(){a.height()-2*e-c.height()>0?c.css({top:(a.height()-2*e-c.height())/2}):c.css({top:0})},l=function(o){d.append('<iframe src="'+o+'?autoplay=1" frameborder="0" allowfullscreen></iframe>')},h=function(){var o,n=document.createElement("div");return n.className="popup__scrollbar-measure",document.body.appendChild(n),o=n.offsetWidth-n.clientWidth,document.body.removeChild(n),o},_=function(){i.css({overflowY:"hidden"}),s.css({overflowY:"auto",paddingRight:0}),i.removeClass("popup_opened"),i.addClass("popup_hide"),r=setTimeout(function(){i.css({overflowY:"auto"}),i.removeClass("popup_hide")},300),u.hasClass("popup__video")&&d.find("iframe").remove()},m=function(){i[0].obj=n,v()},v=function(){a.on({resize:function(){f()}}),t.on({click:function(){return g($(this).attr("data-popup")),"video"==$(this).attr("data-popup")&&l($(this).attr("data-video")),!1}}),u.on({click:function(o){o.stopPropagation()}}),i.on({click:function(){return _(),!1}}),p.on({click:function(){return _(),!1}})},g=function(o){w(o),console.log(o),s.css({overflowY:"hidden",paddingRight:h()}),i.addClass("popup_opened"),f()},w=function(o){var n=u.filter(".popup__"+o);u.css({display:"none"}),n.css({display:"block"})};m()}}();
!function(){"use strict";$(function(){$.each($(".slides"),function(){new n($(this))})});var n=function(n){var i=this,t=n,o=$(window),s=function(){o.on({scroll:function(){a()}})},a=function(){var n=o.height();t.each(function(){var i=$(this),s=t.offset().top;o.scrollTop()>s-n/1.3&&!i.hasClass("animation")&&i.addClass("animation")})},c=function(){t[0].slides=i,s(),a()};c()}}();
!function(){"use strict";$(function(){$.each($(".contact__map"),function(){new n($(this))})});var n=function(n){this.obj=n,this.mapWrap=this.obj;var o,t=this,e=[],a=null,i=function(){c(),l()},s=function(){var n={zoom:a.zoom,scrollwheel:!1};o=new google.maps.Map(t.mapWrap[0],n),g(o)},c=function(){$.getJSON("json/contact-map.json",{},function(n){a=n,google.maps.event.addDomListener(window,"load",s)})},l=function(){},g=function(n){for(var o=0;o<a.places.length;o++)m(o,n)},m=function(n,t){setTimeout(function(){var i=a.places[n],s=new google.maps.LatLng(i.lat,i.lng),c=new google.maps.LatLngBounds;e[n]=new google.maps.Marker({position:s,map:t,clickable:!1,icon:{url:i.icon,scaledSize:new google.maps.Size(i.size[0],i.size[1])},animation:google.maps.Animation.DROP});for(var l=0;l<e.length;l++)""!==e[l]&&c.extend(e[l].getPosition());o.fitBounds(c)},300*n)};i()}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIiwianF1ZXJ5LnBvcHVwLmpzIiwianF1ZXJ5LmFuaW1hdGlvbi5qcyIsImpxdWVyeS5jb250YWN0LmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwiTWVudSIsInRoaXMiLCJMYW5ndWFnZSIsIm9iaiIsIl9tb3VzZWVudGVyVGltZW91dCIsIl9tb3VzZWxlYXZlVGltZW91dCIsIl9vYmoiLCJfbGFuZ3VhZ2VzRHJvcERvd24iLCJfbGFuZ3VhZ2VzSXRlbSIsIl9sYW5ndWFnZXNEcm9wRG93blNwZWVkIiwiX2FkZEV2ZW50cyIsIndpbmRvdyIsIm9uIiwiY2xpY2siLCJlIiwicGFyZW50IiwiaGFzQ2xhc3MiLCJ0cmlnZ2VyIiwicHJldmVudERlZmF1bHQiLCJhcHBlbmRUbyIsInN0b3AiLCJzbGlkZVVwIiwibW91c2VlbnRlciIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJzbGlkZURvd24iLCJtb3VzZWxlYXZlIiwiaXMiLCJfaW5pdCIsIl9zZWxmIiwiX21lbnUiLCJfYm9keSIsIl93aW5kb3ciLCJfc2hvd0J0biIsIl9vbkV2ZW50cyIsIl9vcGVuTWVudSIsInJlc2l6ZSIsIl9yZXNldFN0eWxlIiwic2Nyb2xsIiwiX2NoZWNrU2Nyb2xsIiwid2luZG93U2Nyb2xsIiwic2Nyb2xsVG9wIiwiaGVyb0hlaWdodCIsImlubmVySGVpZ2h0IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImVsZW0iLCJjdXJJdGVtIiwiY3NzIiwib3ZlcmZsb3ciLCJyZW1vdmVBdHRyIiwiUG9wdXAiLCJfcG9wdXBQYWRkaW5nIiwiX2J0blNob3ciLCJfYnRuQ2xvc2UiLCJmaW5kIiwiX3dyYXAiLCJfY29udGVudHMiLCJfc2Nyb2xsQ29udGVpbmVyIiwiX3ZpZGVvUG9wdXAiLCJfdGltZXIiLCJfY2VudGVyV3JhcCIsImhlaWdodCIsInRvcCIsIl9hZGRWaWRlb0ZyYW1lIiwidXJsIiwiYXBwZW5kIiwiX2dldFNjcm9sbFdpZHRoIiwic2Nyb2xsQmFyV2lkdGgiLCJzY3JvbGxEaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJvZmZzZXRXaWR0aCIsImNsaWVudFdpZHRoIiwicmVtb3ZlQ2hpbGQiLCJfaGlkZSIsIm92ZXJmbG93WSIsInBhZGRpbmdSaWdodCIsInJlbW92ZSIsIl9zaG93IiwiYXR0ciIsInN0b3BQcm9wYWdhdGlvbiIsIl9zZXRQb3B1cENvbnRlbnQiLCJjb25zb2xlIiwibG9nIiwiY3VyQ29udGVudCIsImZpbHRlciIsImRpc3BsYXkiLCJTbGlkZXMiLCJ3aW5kb3dIIiwidG9wUG9zIiwib2Zmc2V0Iiwic2xpZGVzIiwiTWFwIiwibWFwV3JhcCIsIl9tYXAiLCJfbWFya2VycyIsIl9kYXRhIiwiX2NvbnN0cnVjdG9yIiwiX2xvYWREYXRhIiwiX2luaXRNYXAiLCJtYXBPcHRpb25zIiwiem9vbSIsInNjcm9sbHdoZWVsIiwiZ29vZ2xlIiwibWFwcyIsIl9zZXRNYXJrZXJzIiwiZ2V0SlNPTiIsImRhdGEiLCJldmVudCIsImFkZERvbUxpc3RlbmVyIiwibWFwIiwiaiIsImxlbmd0aCIsIl9hZGRNYXJrZXIiLCJpIiwiY3VyTGF0TG5nIiwiTGF0TG5nIiwiYm91bmRzIiwiTGF0TG5nQm91bmRzIiwiTWFya2VyIiwicG9zaXRpb24iLCJjbGlja2FibGUiLCJpY29uIiwic2NhbGVkU2l6ZSIsIlNpemUiLCJhbmltYXRpb24iLCJBbmltYXRpb24iLCJEUk9QIiwiZXh0ZW5kIiwiZ2V0UG9zaXRpb24iLCJmaXRCb3VuZHMiXSwibWFwcGluZ3MiOiJBQUFBLGNBQ0EsV0FFSUEsRUFBRyxXQUVDQSxFQUFFQyxLQUFNRCxFQUFHLGVBQWlCLFdBRXhCLEdBQUlFLEdBQU9GLEVBQUdHLFNBSWxCSCxFQUFFQyxLQUFNRCxFQUFHLGFBQWUsV0FFdEIsR0FBSUksR0FBV0osRUFBRUcsVUFLekIsSUFBSUMsR0FBVyxTQUFVQyxHQUdyQixHQUlJQyxHQUNBQyxFQUxBQyxFQUFP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QUFHQSxFQUFJZixFQUFnQixPQUFFZ0IsT0FBUUQsSUFFekNFLEVBQVlGLEVBQUdELElBR3ZCRyxFQUFhLFNBQVdDLEVBQUdKLEdBRXZCMUYsV0FBVyxXQUVQLEdBQUl1QixHQUFVcUQsRUFBZ0IsT0FBRWtCLEdBQzVCQyxFQUFZLEdBQUlaLFFBQU9DLEtBQUtZLE9BQVF6RSxFQUFlLElBQUdBLEVBQWUsS0FDckUwRSxFQUFTLEdBQUlkLFFBQU9DLEtBQUtjLFlBRTdCdkIsR0FBVW1CLEdBQU0sR0FBSVgsUUFBT0MsS0FBS2UsUUFDNUJDLFNBQVVMLEVBQ1ZMLElBQUtBLEVBQ0xXLFdBQVcsRUFDWEMsTUFDSTdELElBQUtsQixFQUFnQixLQUNyQmdGLFdBQVksR0FBSXBCLFFBQU9DLEtBQUtvQixLQUFNakYsRUFBZ0IsS0FBRyxHQUFLQSxFQUFnQixLQUFHLEtBRWpGa0YsVUFBV3RCLE9BQU9DLEtBQUtzQixVQUFVQyxNQUlyQyxLQUFNLEdBQUloQixHQUFJLEVBQUdBLEVBQUloQixFQUFTaUIsT0FBUUQsSUFFWCxLQUFsQmhCLEVBQVVnQixJQUNYTSxFQUFPVyxPQUFRakMsRUFBVWdCLEdBQUlrQixjQUlyQ25DLEdBQUtvQyxVQUFXYixJQUViLElBQUpILEdBSVhqQiIsImZpbGUiOiJjb250YWN0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuKCBmdW5jdGlvbigpIHtcblxuICAgICQoIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICQuZWFjaCggJCggJy5zaXRlX19tZW51JyApLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgbmV3IE1lbnUgKCAkKCB0aGlzICkgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICAgICAgJC5lYWNoKCAkKCAnLmxhbmd1YWdlJyApLCBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICBuZXcgTGFuZ3VhZ2UgKCAkKHRoaXMpIClcblxuICAgICAgICB9ICk7XG4gICAgfSk7XG5cbiAgICB2YXIgTGFuZ3VhZ2UgPSBmdW5jdGlvbiAob2JqKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfbGFuZ3VhZ2VzRHJvcERvd24gPSAkKCAnLmxhbmd1YWdlX19kcm9wZG93bicgKSxcbiAgICAgICAgICAgIF9sYW5ndWFnZXNJdGVtID0gJCggJy5sYW5ndWFnZV9faXRlbScgKSxcbiAgICAgICAgICAgIF9sYW5ndWFnZXNEcm9wRG93blNwZWVkID0gMjAwLFxuICAgICAgICAgICAgX21vdXNlZW50ZXJUaW1lb3V0LFxuICAgICAgICAgICAgX21vdXNlbGVhdmVUaW1lb3V0LFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX2xhbmd1YWdlc0l0ZW0ub24oe1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCBlICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggJCggdGhpcyApLnBhcmVudCgpLmhhc0NsYXNzKCAnbGFuZ3VhZ2VfX2FjdGl2ZScgKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoudHJpZ2dlcignbW91c2VlbnRlcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoICQoIHRoaXMgKS5wYXJlbnQoKS5oYXNDbGFzcyggJ2xhbmd1YWdlX19kcm9wZG93bicgKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoICcubGFuZ3VhZ2VfX2FjdGl2ZSAubGFuZ3VhZ2VfX2l0ZW0nICkuYXBwZW5kVG8oIF9sYW5ndWFnZXNEcm9wRG93biApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggdGhpcyApLmFwcGVuZFRvKCAnLmxhbmd1YWdlX19hY3RpdmUnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbGFuZ3VhZ2VzRHJvcERvd24uc3RvcCggdHJ1ZSwgdHJ1ZSApLnNsaWRlVXAoIF9sYW5ndWFnZXNEcm9wRG93blNwZWVkICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIF9vYmoub24oe1xuICAgICAgICAgICAgICAgICAgICBtb3VzZWVudGVyOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCggX21vdXNlbGVhdmVUaW1lb3V0ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9tb3VzZWVudGVyVGltZW91dCA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xhbmd1YWdlc0Ryb3BEb3duLnN0b3AoIHRydWUsIHRydWUgKS5zbGlkZURvd24oIF9sYW5ndWFnZXNEcm9wRG93blNwZWVkICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIF9vYmoub24oe1xuICAgICAgICAgICAgICAgICAgICBtb3VzZWxlYXZlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCggX21vdXNlZW50ZXJUaW1lb3V0ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9tb3VzZWxlYXZlVGltZW91dCA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoX2xhbmd1YWdlc0Ryb3BEb3duLmlzKCAnOnZpc2libGUnICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xhbmd1YWdlc0Ryb3BEb3duLnN0b3AoIHRydWUsIHRydWUgKS5zbGlkZVVwKCBfbGFuZ3VhZ2VzRHJvcERvd25TcGVlZCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXG5cbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xuXG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIE1lbnUgPSBmdW5jdGlvbiggb2JqICkge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfbWVudSA9IG9iaixcbiAgICAgICAgICAgIF9ib2R5ID0gJCggJ2JvZHknICksXG4gICAgICAgICAgICBfd2luZG93ID0gJCggd2luZG93ICksXG4gICAgICAgICAgICBfc2hvd0J0biA9ICQoICcuc2l0ZV9fbWVudS1idG4nICk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgX3Nob3dCdG4ub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfb3Blbk1lbnUoICQoIHRoaXMgKSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVzZXRTdHlsZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoZWNrU2Nyb2xsID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpbmRvd1Njcm9sbCA9IF93aW5kb3cuc2Nyb2xsVG9wKCksXG4gICAgICAgICAgICAgICAgICAgIGhlcm9IZWlnaHQgPSAkKCcuc2l0ZV9faGVybycpLmlubmVySGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIHdpbmRvd1Njcm9sbCA+IGhlcm9IZWlnaHQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCAhX3Nob3dCdG4uaGFzQ2xhc3MoICdhY3RpdmUnICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9zaG93QnRuLmFkZENsYXNzKCdhY3RpdmUnKVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX3Nob3dCdG4ucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfb3Blbk1lbnUgPSBmdW5jdGlvbiggZWxlbSApICB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9IGVsZW07XG5cbiAgICAgICAgICAgICAgICBpZiggY3VySXRlbS5oYXNDbGFzcyggJ29wZW5lZCcgKSApIHtcblxuICAgICAgICAgICAgICAgICAgICBjdXJJdGVtLnJlbW92ZUNsYXNzKCAnb3BlbmVkJyApO1xuICAgICAgICAgICAgICAgICAgICBfbWVudS5yZW1vdmVDbGFzcyggJ29wZW5lZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICBfYm9keS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdyc6ICd2aXNpYmxlJ1xuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0uYWRkQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIF9tZW51LmFkZENsYXNzKCAnb3BlbmVkJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIF9ib2R5LmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93JzogJ2hpZGRlbidcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9yZXNldFN0eWxlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBfc2hvd0J0bi5yZW1vdmVDbGFzcyggJ29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICBfbWVudS5yZW1vdmVBdHRyKCAnc3R5bGUnICk7XG4gICAgICAgICAgICAgICAgX2JvZHkuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdyc6ICd2aXNpYmxlJ1xuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX21lbnVbIDAgXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfb25FdmVudHMoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG59ICkoKTtcbiIsIiggZnVuY3Rpb24oKXtcblxuICAgICQoIGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgJCggJy5wb3B1cCcgKS5lYWNoKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIG5ldyBQb3B1cCgkKHRoaXMpKTtcblxuICAgICAgICB9KTtcblxuICAgIH0pO1xuXG4gICAgdmFyIFBvcHVwID0gZnVuY3Rpb24oIG9iaiApe1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfcG9wdXBQYWRkaW5nID0gNDAsXG4gICAgICAgICAgICBfYnRuU2hvdyA9ICAkKCAnLnBvcHVwX19vcGVuJyApLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9idG5DbG9zZSA9IF9vYmouZmluZCggJy5wb3B1cF9fY2xvc2UsIC5wb3B1cF9fY2FuY2VsJyApLFxuICAgICAgICAgICAgX3dyYXAgPSBfb2JqLmZpbmQoICcucG9wdXBfX3dyYXAnICksXG4gICAgICAgICAgICBfY29udGVudHMgPSBfb2JqLmZpbmQoICcucG9wdXBfX2NvbnRlbnQnICksXG4gICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyID0gJCggJ2h0bWwnICksXG4gICAgICAgICAgICBfd2luZG93ID0gJCggd2luZG93ICksXG4gICAgICAgICAgICBfdmlkZW9Qb3B1cCA9ICQoICcucG9wdXBfX3ZpZGVvJyApLFxuICAgICAgICAgICAgX3RpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKXt9LCAxICk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9jZW50ZXJXcmFwID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoIF93aW5kb3cuaGVpZ2h0KCkgLSAoIF9wb3B1cFBhZGRpbmcgKiAyICkgLSBfd3JhcC5oZWlnaHQoKSA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIF93cmFwLmNzcyggeyB0b3A6ICggKCBfd2luZG93LmhlaWdodCgpIC0gKCBfcG9wdXBQYWRkaW5nICogMiApICkgLSBfd3JhcC5oZWlnaHQoKSApIC8gMiB9ICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3dyYXAuY3NzKCB7IHRvcDogMCB9ICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9hZGRWaWRlb0ZyYW1lID0gZnVuY3Rpb24gKCB1cmwgKSB7XG5cbiAgICAgICAgICAgICAgICBfdmlkZW9Qb3B1cC5hcHBlbmQoICc8aWZyYW1lIHNyYz1cIicrdXJsKyc/YXV0b3BsYXk9MVwiIGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4nIClcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9nZXRTY3JvbGxXaWR0aCA9IGZ1bmN0aW9uICgpe1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyksXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbEJhcldpZHRoO1xuXG4gICAgICAgICAgICAgICAgc2Nyb2xsRGl2LmNsYXNzTmFtZSA9ICdwb3B1cF9fc2Nyb2xsYmFyLW1lYXN1cmUnO1xuXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggc2Nyb2xsRGl2ICk7XG5cbiAgICAgICAgICAgICAgICBzY3JvbGxCYXJXaWR0aCA9IHNjcm9sbERpdi5vZmZzZXRXaWR0aCAtIHNjcm9sbERpdi5jbGllbnRXaWR0aDtcblxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoIHNjcm9sbERpdiApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjcm9sbEJhcldpZHRoO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9oaWRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdoaWRkZW4nXG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9zY3JvbGxDb250ZWluZXIuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2F1dG8nLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IDBcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAncG9wdXBfb3BlbmVkJyApO1xuICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoICdwb3B1cF9oaWRlJyApO1xuXG4gICAgICAgICAgICAgICAgX3RpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLmNzcyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnYXV0bydcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3BvcHVwX2hpZGUnICk7XG4gICAgICAgICAgICAgICAgfSwgMzAwICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIF9jb250ZW50cy5oYXNDbGFzcygncG9wdXBfX3ZpZGVvJykgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX3ZpZGVvUG9wdXAuZmluZCgnaWZyYW1lJykucmVtb3ZlKClcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX29uRXZlbnRzKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX29uRXZlbnRzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jZW50ZXJXcmFwKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX2J0blNob3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc2hvdyggJCggdGhpcyApLmF0dHIoICdkYXRhLXBvcHVwJyApICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggJCggdGhpcyApLmF0dHIoICdkYXRhLXBvcHVwJykgPT0gJ3ZpZGVvJyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRWaWRlb0ZyYW1lKCAkKCB0aGlzICkuYXR0ciggJ2RhdGEtdmlkZW8nICkgKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX3dyYXAub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCBlICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9vYmoub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9idG5DbG9zZS5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3Nob3cgPSBmdW5jdGlvbiggY2xhc3NOYW1lICl7XG5cbiAgICAgICAgICAgICAgICBfc2V0UG9wdXBDb250ZW50KCBjbGFzc05hbWUgKTtcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGNsYXNzTmFtZSk7XG5cblxuXG4gICAgICAgICAgICAgICAgX3Njcm9sbENvbnRlaW5lci5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnaGlkZGVuJyxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiBfZ2V0U2Nyb2xsV2lkdGgoKVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoICdwb3B1cF9vcGVuZWQnICk7XG5cbiAgICAgICAgICAgICAgICBfY2VudGVyV3JhcCgpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldFBvcHVwQ29udGVudCA9IGZ1bmN0aW9uKCBjbGFzc05hbWUgKXtcbiAgICAgICAgICAgICAgICB2YXIgY3VyQ29udGVudCA9IF9jb250ZW50cy5maWx0ZXIoICcucG9wdXBfXycgKyBjbGFzc05hbWUgKTtcblxuICAgICAgICAgICAgICAgIF9jb250ZW50cy5jc3MoIHsgZGlzcGxheTogJ25vbmUnIH0gKTtcbiAgICAgICAgICAgICAgICBjdXJDb250ZW50LmNzcyggeyBkaXNwbGF5OiAnYmxvY2snIH0gKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcblxuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcbn0gKSgpO1xuXG4iLCJcbiggZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoICcuc2xpZGVzJyApLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIG5ldyBTbGlkZXMgKCAkKCB0aGlzICkgKTtcbiAgICAgICAgfSApO1xuXG4gICAgfSk7XG5cbiAgICB2YXIgU2xpZGVzID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfd2luZG93ID0gJCggd2luZG93ICk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9vbkV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKHtcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tTY3JvbGwgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpbmRvd0ggPSBfd2luZG93LmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgX29iai5lYWNoKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3BQb3MgPSBfb2JqLm9mZnNldCgpLnRvcDtcblxuICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy5zY3JvbGxUb3AoKSA+ICh0b3BQb3MgLSB3aW5kb3dILzEuMykgJiYgIWN1ckl0ZW0uaGFzQ2xhc3MoICdhbmltYXRpb24nICkgKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcyggJ2FuaW1hdGlvbicgKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfb2JqWzBdLnNsaWRlcyA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXG5cbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7XG5cblxuXG5cbiIsIlxuKCBmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICQoIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICQuZWFjaCggJCggJy5jb250YWN0X19tYXAnICksIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBuZXcgTWFwICggJCggdGhpcyApICk7XG5cbiAgICAgICAgfSApO1xuICAgIH0pO1xuXG4gICAgdmFyIE1hcCA9IGZ1bmN0aW9uICggb2JqICkge1xuXG4gICAgICAgIHRoaXMub2JqID0gb2JqO1xuICAgICAgICB0aGlzLm1hcFdyYXAgPSB0aGlzLm9iajtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX21hcCxcbiAgICAgICAgICAgIF9tYXJrZXJzID0gW10sXG4gICAgICAgICAgICBfZGF0YSA9IG51bGw7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9jb25zdHJ1Y3RvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfbG9hZERhdGEoKTtcbiAgICAgICAgICAgICAgICBfb25FdmVudHMoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdE1hcCA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIHZhciBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICB6b29tOiBfZGF0YVsgJ3pvb20nIF0sXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBfbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcCggX3NlbGYubWFwV3JhcFswXSwgbWFwT3B0aW9ucyApO1xuICAgICAgICAgICAgICAgIF9zZXRNYXJrZXJzKCBfbWFwICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfbG9hZERhdGEgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAkLmdldEpTT04oJ2pzb24vY29udGFjdC1tYXAuanNvbicsIHt9LCBmdW5jdGlvbiggZGF0YSApe1xuXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkRG9tTGlzdGVuZXIod2luZG93LCAnbG9hZCcsIF9pbml0TWFwKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldE1hcmtlcnMgPSBmdW5jdGlvbiAoIG1hcCApIHtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPTA7IGogPCBfZGF0YVsgJ3BsYWNlcycgXS5sZW5ndGg7IGorKykge1xuXG4gICAgICAgICAgICAgICAgICAgIF9hZGRNYXJrZXIoIGosIG1hcCApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9hZGRNYXJrZXIgPSBmdW5jdGlvbiAoIGksIG1hcCApIHtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSBfZGF0YVsgJ3BsYWNlcycgXVtpXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckxhdExuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoIGN1ckl0ZW1bICdsYXQnIF0sIGN1ckl0ZW1bICdsbmcnIF0gKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdW5kcyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmdCb3VuZHMoKTtcblxuICAgICAgICAgICAgICAgICAgICBfbWFya2Vyc1sgaSBdID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcigge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGN1ckxhdExuZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2thYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGN1ckl0ZW1bICdpY29uJyBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKCBjdXJJdGVtWyAnc2l6ZScgXVsgMCBdLCBjdXJJdGVtWyAnc2l6ZScgXVsgMSBdIClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QXG5cbiAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAoIHZhciBqID0gMDsgaiA8IF9tYXJrZXJzLmxlbmd0aDsgaisrICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIF9tYXJrZXJzWyBqIF0gIT09ICcnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdW5kcy5leHRlbmQoIF9tYXJrZXJzWyBqIF0uZ2V0UG9zaXRpb24oKSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgX21hcC5maXRCb3VuZHMoIGJvdW5kcyApO1xuXG4gICAgICAgICAgICAgICAgfSwgaSAqIDMwMCk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2NvbnN0cnVjdG9yKCk7XG4gICAgfTtcblxufSApKCk7XG4iXX0=
