"use strict";!function(){$(function(){$.each($(".site__menu"),function(){new n($(this))}),$.each($(".language"),function(){new e($(this))})});var e=function(e){var n,o,i=e,s=$(".language__dropdown"),t=$(".language__item"),a=200,c=($(window),function(){t.on({click:function(e){$(this).parent().hasClass("language__active")&&(i.trigger("mouseenter"),e.preventDefault()),$(this).parent().hasClass("language__dropdown")&&($(".language__active .language__item").appendTo(s),$(this).appendTo(".language__active"),s.stop(!0,!0).slideUp(a))}}),i.on({mouseenter:function(){clearTimeout(o),n=setTimeout(function(){s.stop(!0,!0).slideDown(a)},200)}}),i.on({mouseleave:function(){clearTimeout(n),o=setTimeout(function(){s.is(":visible")&&s.stop(!0,!0).slideUp(a)},200)}})}),u=function(){c()};u()},n=function(e){var n=this,o=e,i=$("body"),s=$(window),t=$(".site__menu-btn"),a=function(){t.on({click:function(){u($(this))}}),s.on({resize:function(){l()},scroll:function(){c()}})},c=function(){var e=s.scrollTop(),n=$(".site__hero").innerHeight();e>n?t.hasClass("active")||t.addClass("active"):t.removeClass("active")},u=function(e){var n=e;n.hasClass("opened")?(n.removeClass("opened"),o.removeClass("opened"),i.css({overflow:"visible"})):(n.addClass("opened"),o.addClass("opened"),i.css({overflow:"hidden"}))},l=function(){t.removeClass("opened"),o.removeAttr("style"),i.css({overflow:"visible"})},r=function(){o[0].obj=n,a()};r()}}();
!function(){$(function(){$(".popup").each(function(){new o($(this))})});var o=function(o){var n=this,t=40,p=$(".popup__open"),i=o,e=i.find(".popup__close, .popup__cancel"),c=i.find(".popup__wrap"),u=i.find(".popup__content"),a=$("html"),s=$(window),d=$(".popup__video"),r=setTimeout(function(){},1),f=function(){s.height()-2*t-c.height()>0?c.css({top:(s.height()-2*t-c.height())/2}):c.css({top:0})},l=function(o){d.append('<iframe src="'+o+'?autoplay=1" frameborder="0" allowfullscreen></iframe>')},h=function(){var o,n=document.createElement("div");return n.className="popup__scrollbar-measure",document.body.appendChild(n),o=n.offsetWidth-n.clientWidth,document.body.removeChild(n),o},_=function(){i.css({overflowY:"hidden"}),a.css({overflowY:"auto",paddingRight:0}),i.removeClass("popup_opened"),i.addClass("popup_hide"),r=setTimeout(function(){i.css({overflowY:"auto"}),i.removeClass("popup_hide")},300),u.hasClass("popup__video")&&d.find("iframe").remove()},m=function(){i[0].obj=n,v()},v=function(){s.on({resize:function(){f()}}),p.on({click:function(){return g($(this).attr("data-popup")),"video"==$(this).attr("data-popup")&&l($(this).attr("data-video")),"book"==$(this).attr("data-popup")&&$(".popup__book .booking")[0].list.initSwiper(),!1}}),u.on({click:function(o){o.stopPropagation()}}),i.on({click:function(){return _(),!1}}),e.on({click:function(){return _(),!1}})},g=function(o){w(o),console.log(o),a.css({overflowY:"hidden",paddingRight:h()}),i.addClass("popup_opened"),f()},w=function(o){var n=u.filter(".popup__"+o);u.css({display:"none"}),n.css({display:"block"})};m()}}();
!function(){"use strict";$(function(){$.each($(".slides"),function(){new n($(this))})});var n=function(n){var i=this,t=n,o=$(window),s=function(){o.on({scroll:function(){a()}})},a=function(){var n=o.height();t.each(function(){var i=$(this),s=t.offset().top;o.scrollTop()>s-n/1.3&&!i.hasClass("animation")&&i.addClass("animation")})},c=function(){t[0].slides=i,s(),a()};c()}}();
!function(){"use strict";$(function(){$.each($(".contact__map"),function(){new n($(this))})});var n=function(n){this.obj=n,this.mapWrap=this.obj;var o,t=this,e=[],a=null,i=function(){c(),l()},s=function(){var n={zoom:a.zoom,scrollwheel:!1};o=new google.maps.Map(t.mapWrap[0],n),g(o)},c=function(){$.getJSON("json/contact-map.json",{},function(n){a=n,google.maps.event.addDomListener(window,"load",s)})},l=function(){},g=function(n){for(var o=0;o<a.places.length;o++)m(o,n)},m=function(n,t){setTimeout(function(){var i=a.places[n],s=new google.maps.LatLng(i.lat,i.lng),c=new google.maps.LatLngBounds;e[n]=new google.maps.Marker({position:s,map:t,clickable:!1,icon:{url:i.icon,scaledSize:new google.maps.Size(i.size[0],i.size[1])},animation:google.maps.Animation.DROP});for(var l=0;l<e.length;l++)""!==e[l]&&c.extend(e[l].getPosition());o.fitBounds(c)},300*n)};i()}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIiwianF1ZXJ5LnBvcHVwLmpzIiwianF1ZXJ5LmFuaW1hdGlvbi5qcyIsImpxdWVyeS5jb250YWN0LmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwiTWVudSIsInRoaXMiLCJMYW5ndWFnZSIsIm9iaiIsIl9tb3VzZWVudGVyVGltZW91dCIsIl9tb3VzZWxlYXZlVGltZW91dCIsIl9vYmoiLCJfbGFuZ3VhZ2VzRHJvcERvd24iLCJfbGFuZ3VhZ2VzSXRlbSIsIl9sYW5ndWFnZXNEcm9wRG93blNwZWVkIiwiX2FkZEV2ZW50cyIsIndpbmRvdyIsIm9uIiwiY2xpY2siLCJlIiwicGFyZW50IiwiaGFzQ2xhc3MiLCJ0cmlnZ2VyIiwicHJldmVudERlZmF1bHQiLCJhcHBlbmRUbyIsInN0b3AiLCJzbGlkZVVwIiwibW91c2VlbnRlciIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJzbGlkZURvd24iLCJtb3VzZWxlYXZlIiwiaXMiLCJfaW5pdCIsIl9zZWxmIiwiX21lbnUiLCJfYm9keSIsIl93aW5kb3ciLCJfc2hvd0J0biIsIl9vbkV2ZW50cyIsIl9vcGVuTWVudSIsInJlc2l6ZSIsIl9yZXNldFN0eWxlIiwic2Nyb2xsIiwiX2NoZWNrU2Nyb2xsIiwid2luZG93U2Nyb2xsIiwic2Nyb2xsVG9wIiwiaGVyb0hlaWdodCIsImlubmVySGVpZ2h0IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImVsZW0iLCJjdXJJdGVtIiwiY3NzIiwib3ZlcmZsb3ciLCJyZW1vdmVBdHRyIiwiUG9wdXAiLCJfcG9wdXBQYWRkaW5nIiwiX2J0blNob3ciLCJfYnRuQ2xvc2UiLCJmaW5kIiwiX3dyYXAiLCJfY29udGVudHMiLCJfc2Nyb2xsQ29udGVpbmVyIiwiX3ZpZGVvUG9wdXAiLCJfdGltZXIiLCJfY2VudGVyV3JhcCIsImhlaWdodCIsInRvcCIsIl9hZGRWaWRlb0ZyYW1lIiwidXJsIiwiYXBwZW5kIiwiX2dldFNjcm9sbFdpZHRoIiwic2Nyb2xsQmFyV2lkdGgiLCJzY3JvbGxEaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJvZmZzZXRXaWR0aCIsImNsaWVudFdpZHRoIiwicmVtb3ZlQ2hpbGQiLCJfaGlkZSIsIm92ZXJmbG93WSIsInBhZGRpbmdSaWdodCIsInJlbW92ZSIsIl9zaG93IiwiYXR0ciIsImxpc3QiLCJpbml0U3dpcGVyIiwic3RvcFByb3BhZ2F0aW9uIiwiX3NldFBvcHVwQ29udGVudCIsImNvbnNvbGUiLCJsb2ciLCJjdXJDb250ZW50IiwiZmlsdGVyIiwiZGlzcGxheSIsIlNsaWRlcyIsIndpbmRvd0giLCJ0b3BQb3MiLCJvZmZzZXQiLCJzbGlkZXMiLCJNYXAiLCJtYXBXcmFwIiwiX21hcCIsIl9tYXJrZXJzIiwiX2RhdGEiLCJfY29uc3RydWN0b3IiLCJfbG9hZERhdGEiLCJfaW5pdE1hcCIsIm1hcE9wdGlvbnMiLCJ6b29tIiwic2Nyb2xsd2hlZWwiLCJnb29nbGUiLCJtYXBzIiwiX3NldE1hcmtlcnMiLCJnZXRKU09OIiwiZGF0YSIsImV2ZW50IiwiYWRkRG9tTGlzdGVuZXIiLCJtYXAiLCJqIiwibGVuZ3RoIiwiX2FkZE1hcmtlciIsImkiLCJjdXJMYXRMbmciLCJMYXRMbmciLCJib3VuZHMiLCJMYXRMbmdCb3VuZHMiLCJNYXJrZXIiLCJwb3NpdGlvbiIsImNsaWNrYWJsZSIsImljb24iLCJzY2FsZWRTaXplIiwiU2l6ZSIsImFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkRST1AiLCJleHRlbmQiLCJnZXRQb3NpdGlvbiIsImZpdEJvdW5kcyJdLCJtYXBwaW5ncyI6IkFBQUEsY0FDQSxXQUVJQSxFQUFHLFdBRUNBLEVBQUVDLEtBQU1ELEVBQUcsZUFBaUIsV0FFeEIsR0FBSUUsR0FBT0YsRUFBR0csU0FJbEJILEVBQUVDLEtBQU1ELEVBQUcsYUFBZSxXQUV0QixHQUFJSSxHQUFXSixFQUFFRyxVQUt6QixJQUFJQyxHQUFXLFNBQVVDLEdBR3JCLEdB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S0FBS0ksTUFBTUMsZUFBZXhHLE9BQVEsT0FBUThGLE1BSXpEdkUsRUFBWSxhQUlaNkUsRUFBYyxTQUFXSyxHQUVyQixJQUFLLEdBQUlDLEdBQUcsRUFBR0EsRUFBSWYsRUFBZ0IsT0FBRWdCLE9BQVFELElBRXpDRSxFQUFZRixFQUFHRCxJQUd2QkcsRUFBYSxTQUFXQyxFQUFHSixHQUV2QjVGLFdBQVcsV0FFUCxHQUFJdUIsR0FBVXVELEVBQWdCLE9BQUVrQixHQUM1QkMsRUFBWSxHQUFJWixRQUFPQyxLQUFLWSxPQUFRM0UsRUFBZSxJQUFHQSxFQUFlLEtBQ3JFNEUsRUFBUyxHQUFJZCxRQUFPQyxLQUFLYyxZQUU3QnZCLEdBQVVtQixHQUFNLEdBQUlYLFFBQU9DLEtBQUtlLFFBQzVCQyxTQUFVTCxFQUNWTCxJQUFLQSxFQUNMVyxXQUFXLEVBQ1hDLE1BQ0kvRCxJQUFLbEIsRUFBZ0IsS0FDckJrRixXQUFZLEdBQUlwQixRQUFPQyxLQUFLb0IsS0FBTW5GLEVBQWdCLEtBQUcsR0FBS0EsRUFBZ0IsS0FBRyxLQUVqRm9GLFVBQVd0QixPQUFPQyxLQUFLc0IsVUFBVUMsTUFJckMsS0FBTSxHQUFJaEIsR0FBSSxFQUFHQSxFQUFJaEIsRUFBU2lCLE9BQVFELElBRVgsS0FBbEJoQixFQUFVZ0IsSUFDWE0sRUFBT1csT0FBUWpDLEVBQVVnQixHQUFJa0IsY0FJckNuQyxHQUFLb0MsVUFBV2IsSUFFYixJQUFKSCxHQUlYakIiLCJmaWxlIjoiY29udGFjdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbiggZnVuY3Rpb24oKSB7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoICcuc2l0ZV9fbWVudScgKSwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIG5ldyBNZW51ICggJCggdGhpcyApICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCggJy5sYW5ndWFnZScgKSwgZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgbmV3IExhbmd1YWdlICggJCh0aGlzKSApXG5cbiAgICAgICAgfSApO1xuICAgIH0pO1xuXG4gICAgdmFyIExhbmd1YWdlID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2xhbmd1YWdlc0Ryb3BEb3duID0gJCggJy5sYW5ndWFnZV9fZHJvcGRvd24nICksXG4gICAgICAgICAgICBfbGFuZ3VhZ2VzSXRlbSA9ICQoICcubGFuZ3VhZ2VfX2l0ZW0nICksXG4gICAgICAgICAgICBfbGFuZ3VhZ2VzRHJvcERvd25TcGVlZCA9IDIwMCxcbiAgICAgICAgICAgIF9tb3VzZWVudGVyVGltZW91dCxcbiAgICAgICAgICAgIF9tb3VzZWxlYXZlVGltZW91dCxcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKCB3aW5kb3cgKTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF9sYW5ndWFnZXNJdGVtLm9uKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICggZSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoICQoIHRoaXMgKS5wYXJlbnQoKS5oYXNDbGFzcyggJ2xhbmd1YWdlX19hY3RpdmUnICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLnRyaWdnZXIoJ21vdXNlZW50ZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkKCB0aGlzICkucGFyZW50KCkuaGFzQ2xhc3MoICdsYW5ndWFnZV9fZHJvcGRvd24nICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCAnLmxhbmd1YWdlX19hY3RpdmUgLmxhbmd1YWdlX19pdGVtJyApLmFwcGVuZFRvKCBfbGFuZ3VhZ2VzRHJvcERvd24gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIHRoaXMgKS5hcHBlbmRUbyggJy5sYW5ndWFnZV9fYWN0aXZlJyApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xhbmd1YWdlc0Ryb3BEb3duLnN0b3AoIHRydWUsIHRydWUgKS5zbGlkZVVwKCBfbGFuZ3VhZ2VzRHJvcERvd25TcGVlZCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLm9uKHtcbiAgICAgICAgICAgICAgICAgICAgbW91c2VlbnRlcjogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoIF9tb3VzZWxlYXZlVGltZW91dCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbW91c2VlbnRlclRpbWVvdXQgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sYW5ndWFnZXNEcm9wRG93bi5zdG9wKCB0cnVlLCB0cnVlICkuc2xpZGVEb3duKCBfbGFuZ3VhZ2VzRHJvcERvd25TcGVlZCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLm9uKHtcbiAgICAgICAgICAgICAgICAgICAgbW91c2VsZWF2ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoIF9tb3VzZWVudGVyVGltZW91dCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbW91c2VsZWF2ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKF9sYW5ndWFnZXNEcm9wRG93bi5pcyggJzp2aXNpYmxlJyApICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sYW5ndWFnZXNEcm9wRG93bi5zdG9wKCB0cnVlLCB0cnVlICkuc2xpZGVVcCggX2xhbmd1YWdlc0Ryb3BEb3duU3BlZWQgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcblxuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxuICAgIHZhciBNZW51ID0gZnVuY3Rpb24oIG9iaiApIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX21lbnUgPSBvYmosXG4gICAgICAgICAgICBfYm9keSA9ICQoICdib2R5JyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX3Nob3dCdG4gPSAkKCAnLnNpdGVfX21lbnUtYnRuJyApO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfb25FdmVudHMgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIF9zaG93QnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX29wZW5NZW51KCAkKCB0aGlzICkgKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc2V0U3R5bGUoKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1Njcm9sbCA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3aW5kb3dTY3JvbGwgPSBfd2luZG93LnNjcm9sbFRvcCgpLFxuICAgICAgICAgICAgICAgICAgICBoZXJvSGVpZ2h0ID0gJCgnLnNpdGVfX2hlcm8nKS5pbm5lckhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCB3aW5kb3dTY3JvbGwgPiBoZXJvSGVpZ2h0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggIV9zaG93QnRuLmhhc0NsYXNzKCAnYWN0aXZlJyApICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfc2hvd0J0bi5hZGRDbGFzcygnYWN0aXZlJylcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIF9zaG93QnRuLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX29wZW5NZW51ID0gZnVuY3Rpb24oIGVsZW0gKSAge1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSBlbGVtO1xuXG4gICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uaGFzQ2xhc3MoICdvcGVuZWQnICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5yZW1vdmVDbGFzcyggJ29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgX21lbnUucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgX2JvZHkuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAndmlzaWJsZSdcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBjdXJJdGVtLmFkZENsYXNzKCAnb3BlbmVkJyApO1xuICAgICAgICAgICAgICAgICAgICBfbWVudS5hZGRDbGFzcyggJ29wZW5lZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICBfYm9keS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdyc6ICdoaWRkZW4nXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfcmVzZXRTdHlsZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgX3Nob3dCdG4ucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgX21lbnUucmVtb3ZlQXR0ciggJ3N0eWxlJyApO1xuICAgICAgICAgICAgICAgIF9ib2R5LmNzcygge1xuICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAndmlzaWJsZSdcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF9tZW51WyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX29uRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7XG4iLCIoIGZ1bmN0aW9uKCl7XG5cbiAgICAkKCBmdW5jdGlvbigpe1xuXG4gICAgICAgICQoICcucG9wdXAnICkuZWFjaChmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICBuZXcgUG9wdXAoJCh0aGlzKSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIHZhciBQb3B1cCA9IGZ1bmN0aW9uKCBvYmogKXtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX3BvcHVwUGFkZGluZyA9IDQwLFxuICAgICAgICAgICAgX2J0blNob3cgPSAgJCggJy5wb3B1cF9fb3BlbicgKSxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfYnRuQ2xvc2UgPSBfb2JqLmZpbmQoICcucG9wdXBfX2Nsb3NlLCAucG9wdXBfX2NhbmNlbCcgKSxcbiAgICAgICAgICAgIF93cmFwID0gX29iai5maW5kKCAnLnBvcHVwX193cmFwJyApLFxuICAgICAgICAgICAgX2NvbnRlbnRzID0gX29iai5maW5kKCAnLnBvcHVwX19jb250ZW50JyApLFxuICAgICAgICAgICAgX3Njcm9sbENvbnRlaW5lciA9ICQoICdodG1sJyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX3ZpZGVvUG9wdXAgPSAkKCAnLnBvcHVwX192aWRlbycgKSxcbiAgICAgICAgICAgIF90aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7fSwgMSApO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfY2VudGVyV3JhcCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKCBfd2luZG93LmhlaWdodCgpIC0gKCBfcG9wdXBQYWRkaW5nICogMiApIC0gX3dyYXAuaGVpZ2h0KCkgPiAwICkge1xuICAgICAgICAgICAgICAgICAgICBfd3JhcC5jc3MoIHsgdG9wOiAoICggX3dpbmRvdy5oZWlnaHQoKSAtICggX3BvcHVwUGFkZGluZyAqIDIgKSApIC0gX3dyYXAuaGVpZ2h0KCkgKSAvIDIgfSApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF93cmFwLmNzcyggeyB0b3A6IDAgfSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfYWRkVmlkZW9GcmFtZSA9IGZ1bmN0aW9uICggdXJsICkge1xuXG4gICAgICAgICAgICAgICAgX3ZpZGVvUG9wdXAuYXBwZW5kKCAnPGlmcmFtZSBzcmM9XCInK3VybCsnP2F1dG9wbGF5PTFcIiBmcmFtZWJvcmRlcj1cIjBcIiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+JyApXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfZ2V0U2Nyb2xsV2lkdGggPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicpLFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxCYXJXaWR0aDtcblxuICAgICAgICAgICAgICAgIHNjcm9sbERpdi5jbGFzc05hbWUgPSAncG9wdXBfX3Njcm9sbGJhci1tZWFzdXJlJztcblxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIHNjcm9sbERpdiApO1xuXG4gICAgICAgICAgICAgICAgc2Nyb2xsQmFyV2lkdGggPSBzY3JvbGxEaXYub2Zmc2V0V2lkdGggLSBzY3JvbGxEaXYuY2xpZW50V2lkdGg7XG5cbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKCBzY3JvbGxEaXYgKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBzY3JvbGxCYXJXaWR0aDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaGlkZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29iai5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnaGlkZGVuJ1xuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiAwXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3BvcHVwX29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCAncG9wdXBfaGlkZScgKTtcblxuICAgICAgICAgICAgICAgIF90aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5jc3MgKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2F1dG8nXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdwb3B1cF9oaWRlJyApO1xuICAgICAgICAgICAgICAgIH0sIDMwMCApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCBfY29udGVudHMuaGFzQ2xhc3MoJ3BvcHVwX192aWRlbycpICkge1xuXG4gICAgICAgICAgICAgICAgICAgIF92aWRlb1BvcHVwLmZpbmQoJ2lmcmFtZScpLnJlbW92ZSgpXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29ialsgMCBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2VudGVyV3JhcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9idG5TaG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3coICQoIHRoaXMgKS5hdHRyKCAnZGF0YS1wb3B1cCcgKSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoICQoIHRoaXMgKS5hdHRyKCAnZGF0YS1wb3B1cCcpID09ICd2aWRlbycgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWRkVmlkZW9GcmFtZSggJCggdGhpcyApLmF0dHIoICdkYXRhLXZpZGVvJyApIClcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkKCB0aGlzICkuYXR0ciggJ2RhdGEtcG9wdXAnKSA9PSAnYm9vaycgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggJy5wb3B1cF9fYm9vayAuYm9va2luZycgKVswXS5saXN0LmluaXRTd2lwZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9jb250ZW50cy5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oIGUgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX29iai5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX2J0bkNsb3NlLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX2hpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2hvdyA9IGZ1bmN0aW9uKCBjbGFzc05hbWUgKXtcblxuICAgICAgICAgICAgICAgIF9zZXRQb3B1cENvbnRlbnQoIGNsYXNzTmFtZSApO1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coY2xhc3NOYW1lKTtcblxuXG5cbiAgICAgICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdoaWRkZW4nLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IF9nZXRTY3JvbGxXaWR0aCgpXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ3BvcHVwX29wZW5lZCcgKTtcblxuICAgICAgICAgICAgICAgIF9jZW50ZXJXcmFwKCk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2V0UG9wdXBDb250ZW50ID0gZnVuY3Rpb24oIGNsYXNzTmFtZSApe1xuICAgICAgICAgICAgICAgIHZhciBjdXJDb250ZW50ID0gX2NvbnRlbnRzLmZpbHRlciggJy5wb3B1cF9fJyArIGNsYXNzTmFtZSApO1xuXG4gICAgICAgICAgICAgICAgX2NvbnRlbnRzLmNzcyggeyBkaXNwbGF5OiAnbm9uZScgfSApO1xuICAgICAgICAgICAgICAgIGN1ckNvbnRlbnQuY3NzKCB7IGRpc3BsYXk6ICdibG9jaycgfSApO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXG5cbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xuXG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xufSApKCk7XG5cbiIsIlxuKCBmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICQoIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICQuZWFjaCggJCggJy5zbGlkZXMnICksIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbmV3IFNsaWRlcyAoICQoIHRoaXMgKSApO1xuICAgICAgICB9ICk7XG5cbiAgICB9KTtcblxuICAgIHZhciBTbGlkZXMgPSBmdW5jdGlvbiAoIG9iaiApIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKCB3aW5kb3cgKTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX29uRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF93aW5kb3cub24oe1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1Njcm9sbCA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2luZG93SCA9IF93aW5kb3cuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLmVhY2goZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcFBvcyA9IF9vYmoub2Zmc2V0KCkudG9wO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LnNjcm9sbFRvcCgpID4gKHRvcFBvcyAtIHdpbmRvd0gvMS4zKSAmJiAhY3VySXRlbS5oYXNDbGFzcyggJ2FuaW1hdGlvbicgKSApe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJJdGVtLmFkZENsYXNzKCAnYW5pbWF0aW9uJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF9vYmpbMF0uc2xpZGVzID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX29uRXZlbnRzKCk7XG4gICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG59ICkoKTtcblxuXG5cblxuIiwiXG4oIGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgJCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJC5lYWNoKCAkKCAnLmNvbnRhY3RfX21hcCcgKSwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIG5ldyBNYXAgKCAkKCB0aGlzICkgKTtcblxuICAgICAgICB9ICk7XG4gICAgfSk7XG5cbiAgICB2YXIgTWFwID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAgICAgdGhpcy5vYmogPSBvYmo7XG4gICAgICAgIHRoaXMubWFwV3JhcCA9IHRoaXMub2JqO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfbWFwLFxuICAgICAgICAgICAgX21hcmtlcnMgPSBbXSxcbiAgICAgICAgICAgIF9kYXRhID0gbnVsbDtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2NvbnN0cnVjdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF9sb2FkRGF0YSgpO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0TWFwID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIG1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHpvb206IF9kYXRhWyAnem9vbScgXSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIF9tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKCBfc2VsZi5tYXBXcmFwWzBdLCBtYXBPcHRpb25zICk7XG4gICAgICAgICAgICAgICAgX3NldE1hcmtlcnMoIF9tYXAgKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9sb2FkRGF0YSA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICQuZ2V0SlNPTignanNvbi9jb250YWN0LW1hcC5qc29uJywge30sIGZ1bmN0aW9uKCBkYXRhICl7XG5cbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGREb21MaXN0ZW5lcih3aW5kb3csICdsb2FkJywgX2luaXRNYXApO1xuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX29uRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2V0TWFya2VycyA9IGZ1bmN0aW9uICggbWFwICkge1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9MDsgaiA8IF9kYXRhWyAncGxhY2VzJyBdLmxlbmd0aDsgaisrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX2FkZE1hcmtlciggaiwgbWFwIClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2FkZE1hcmtlciA9IGZ1bmN0aW9uICggaSwgbWFwICkge1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9IF9kYXRhWyAncGxhY2VzJyBdW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyTGF0TG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyggY3VySXRlbVsgJ2xhdCcgXSwgY3VySXRlbVsgJ2xuZycgXSApLFxuICAgICAgICAgICAgICAgICAgICAgICAgYm91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xuXG4gICAgICAgICAgICAgICAgICAgIF9tYXJrZXJzWyBpIF0gPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogY3VyTGF0TG5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja2FibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogY3VySXRlbVsgJ2ljb24nIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoIGN1ckl0ZW1bICdzaXplJyBdWyAwIF0sIGN1ckl0ZW1bICdzaXplJyBdWyAxIF0gKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1BcblxuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICggdmFyIGogPSAwOyBqIDwgX21hcmtlcnMubGVuZ3RoOyBqKysgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggX21hcmtlcnNbIGogXSAhPT0gJycgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm91bmRzLmV4dGVuZCggX21hcmtlcnNbIGogXS5nZXRQb3NpdGlvbigpICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBfbWFwLmZpdEJvdW5kcyggYm91bmRzICk7XG5cbiAgICAgICAgICAgICAgICB9LCBpICogMzAwKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICBfY29uc3RydWN0b3IoKTtcbiAgICB9O1xuXG59ICkoKTtcbiJdfQ==
