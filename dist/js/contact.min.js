"use strict";!function(){$(function(){$.each($(".site__menu"),function(){new n($(this))}),$.each($(".language"),function(){new e($(this))})});var e=function(e){var n,o,i=e,s=$(".language__dropdown"),t=$(".language__item"),a=200,c=($(window),function(){t.on({click:function(e){$(this).parent().hasClass("language__active")&&(i.trigger("mouseenter"),e.preventDefault()),$(this).parent().hasClass("language__dropdown")&&($(".language__active .language__item").appendTo(s),$(this).appendTo(".language__active"),s.stop(!0,!0).slideUp(a))}}),i.on({mouseenter:function(){clearTimeout(o),n=setTimeout(function(){s.stop(!0,!0).slideDown(a)},200)}}),i.on({mouseleave:function(){clearTimeout(n),o=setTimeout(function(){s.is(":visible")&&s.stop(!0,!0).slideUp(a)},200)}})}),u=function(){c()};u()},n=function(e){var n=this,o=e,i=$("body"),s=$(window),t=$(".site__menu-btn"),a=function(){t.on({click:function(){u($(this))}}),s.on({resize:function(){l()},scroll:function(){c()}})},c=function(){var e=s.scrollTop(),n=$(".site__hero").innerHeight();e>n?t.hasClass("active")||t.addClass("active"):t.removeClass("active")},u=function(e){var n=e;n.hasClass("opened")?(n.removeClass("opened"),o.removeClass("opened"),i.css({overflow:"visible"})):(n.addClass("opened"),o.addClass("opened"),i.css({overflow:"hidden"}))},l=function(){t.removeClass("opened"),o.removeAttr("style"),i.css({overflow:"visible"})},r=function(){o[0].obj=n,a()};r()}}();
!function(){$(function(){$(".popup").each(function(){new o($(this))})});var o=function(o){var n=this,t=40,i=$(".popup__open"),p=o,e=p.find(".popup__close, .popup__cancel"),c=p.find(".popup__wrap"),u=p.find(".popup__content"),a=$("html"),s=$(window),d=$(".popup__video"),r=setTimeout(function(){},1),l=function(){s.height()-2*t-c.height()>0?c.css({top:(s.height()-2*t-c.height())/2}):c.css({top:0})},f=function(o){d.append('<iframe src="'+o+'?autoplay=1" frameborder="0" allowfullscreen></iframe>')},h=function(){var o,n=document.createElement("div");return n.className="popup__scrollbar-measure",document.body.appendChild(n),o=n.offsetWidth-n.clientWidth,document.body.removeChild(n),o},_=function(){p.css({overflowY:"hidden"}),a.css({overflowY:"auto",paddingRight:0}),p.removeClass("popup_opened"),p.addClass("popup_hide"),r=setTimeout(function(){p.css({overflowY:"auto"}),p.removeClass("popup_hide")},300),u.hasClass("popup__video")&&d.find("iframe").remove()},m=function(){p[0].obj=n,v()},v=function(){s.on({resize:function(){l()}}),i.on({click:function(){return g($(this).attr("data-popup")),"video"==$(this).attr("data-popup")&&f($(this).attr("data-video")),"book"==$(this).attr("data-popup")&&($(".popup__book .booking")[0].list.initSwiper(),$(".autocomplete")[0].obj.initAutocomplite()),!1}}),u.on({click:function(o){o.stopPropagation()}}),p.on({click:function(){return _(),!1}}),e.on({click:function(){return _(),!1}})},g=function(o){b(o),console.log(o),a.css({overflowY:"hidden",paddingRight:h()}),p.addClass("popup_opened"),l()},b=function(o){var n=u.filter(".popup__"+o);u.css({display:"none"}),n.css({display:"block"})};m()}}();
!function(){"use strict";$(function(){$.each($(".slides"),function(){new n($(this))})});var n=function(n){var i=this,t=n,o=$(window),s=function(){o.on({scroll:function(){a()}})},a=function(){var n=o.height();t.each(function(){var i=$(this),s=t.offset().top;o.scrollTop()>s-n/1.3&&!i.hasClass("animation")&&i.addClass("animation")})},c=function(){t[0].slides=i,s(),a()};c()}}();
!function(){"use strict";$(function(){$.each($(".contact__map"),function(){new n($(this))})});var n=function(n){this.obj=n,this.mapWrap=this.obj;var o,t=this,e=[],a=null,i=function(){c(),l()},s=function(){var n={zoom:a.zoom,scrollwheel:!1};o=new google.maps.Map(t.mapWrap[0],n),g(o)},c=function(){$.getJSON("json/contact-map.json",{},function(n){a=n,google.maps.event.addDomListener(window,"load",s)})},l=function(){},g=function(n){for(var o=0;o<a.places.length;o++)m(o,n)},m=function(n,t){setTimeout(function(){var i=a.places[n],s=new google.maps.LatLng(i.lat,i.lng),c=new google.maps.LatLngBounds;e[n]=new google.maps.Marker({position:s,map:t,clickable:!1,icon:{url:i.icon,scaledSize:new google.maps.Size(i.size[0],i.size[1])},animation:google.maps.Animation.DROP});for(var l=0;l<e.length;l++)""!==e[l]&&c.extend(e[l].getPosition());o.fitBounds(c)},300*n)};i()}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIiwianF1ZXJ5LnBvcHVwLmpzIiwianF1ZXJ5LmFuaW1hdGlvbi5qcyIsImpxdWVyeS5jb250YWN0LmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwiTWVudSIsInRoaXMiLCJMYW5ndWFnZSIsIm9iaiIsIl9tb3VzZWVudGVyVGltZW91dCIsIl9tb3VzZWxlYXZlVGltZW91dCIsIl9vYmoiLCJfbGFuZ3VhZ2VzRHJvcERvd24iLCJfbGFuZ3VhZ2VzSXRlbSIsIl9sYW5ndWFnZXNEcm9wRG93blNwZWVkIiwiX2FkZEV2ZW50cyIsIndpbmRvdyIsIm9uIiwiY2xpY2siLCJlIiwicGFyZW50IiwiaGFzQ2xhc3MiLCJ0cmlnZ2VyIiwicHJldmVudERlZmF1bHQiLCJhcHBlbmRUbyIsInN0b3AiLCJzbGlkZVVwIiwibW91c2VlbnRlciIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJzbGlkZURvd24iLCJtb3VzZWxlYXZlIiwiaXMiLCJfaW5pdCIsIl9zZWxmIiwiX21lbnUiLCJfYm9keSIsIl93aW5kb3ciLCJfc2hvd0J0biIsIl9vbkV2ZW50cyIsIl9vcGVuTWVudSIsInJlc2l6ZSIsIl9yZXNldFN0eWxlIiwic2Nyb2xsIiwiX2NoZWNrU2Nyb2xsIiwid2luZG93U2Nyb2xsIiwic2Nyb2xsVG9wIiwiaGVyb0hlaWdodCIsImlubmVySGVpZ2h0IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImVsZW0iLCJjdXJJdGVtIiwiY3NzIiwib3ZlcmZsb3ciLCJyZW1vdmVBdHRyIiwiUG9wdXAiLCJfcG9wdXBQYWRkaW5nIiwiX2J0blNob3ciLCJfYnRuQ2xvc2UiLCJmaW5kIiwiX3dyYXAiLCJfY29udGVudHMiLCJfc2Nyb2xsQ29udGVpbmVyIiwiX3ZpZGVvUG9wdXAiLCJfdGltZXIiLCJfY2VudGVyV3JhcCIsImhlaWdodCIsInRvcCIsIl9hZGRWaWRlb0ZyYW1lIiwidXJsIiwiYXBwZW5kIiwiX2dldFNjcm9sbFdpZHRoIiwic2Nyb2xsQmFyV2lkdGgiLCJzY3JvbGxEaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJvZmZzZXRXaWR0aCIsImNsaWVudFdpZHRoIiwicmVtb3ZlQ2hpbGQiLCJfaGlkZSIsIm92ZXJmbG93WSIsInBhZGRpbmdSaWdodCIsInJlbW92ZSIsIl9zaG93IiwiYXR0ciIsImxpc3QiLCJpbml0U3dpcGVyIiwiaW5pdEF1dG9jb21wbGl0ZSIsInN0b3BQcm9wYWdhdGlvbiIsIl9zZXRQb3B1cENvbnRlbnQiLCJjb25zb2xlIiwibG9nIiwiY3VyQ29udGVudCIsImZpbHRlciIsImRpc3BsYXkiLCJTbGlkZXMiLCJ3aW5kb3dIIiwidG9wUG9zIiwib2Zmc2V0Iiwic2xpZGVzIiwiTWFwIiwibWFwV3JhcCIsIl9tYXAiLCJfbWFya2VycyIsIl9kYXRhIiwiX2NvbnN0cnVjdG9yIiwiX2xvYWREYXRhIiwiX2luaXRNYXAiLCJtYXBPcHRpb25zIiwiem9vbSIsInNjcm9sbHdoZWVsIiwiZ29vZ2xlIiwibWFwcyIsIl9zZXRNYXJrZXJzIiwiZ2V0SlNPTiIsImRhdGEiLCJldmVudCIsImFkZERvbUxpc3RlbmVyIiwibWFwIiwiaiIsImxlbmd0aCIsIl9hZGRNYXJrZXIiLCJpIiwiY3VyTGF0TG5nIiwiTGF0TG5nIiwiYm91bmRzIiwiTGF0TG5nQm91bmRzIiwiTWFya2VyIiwicG9zaXRpb24iLCJjbGlja2FibGUiLCJpY29uIiwic2NhbGVkU2l6ZSIsIlNpemUiLCJhbmltYXRpb24iLCJBbmltYXRpb24iLCJEUk9QIiwiZXh0ZW5kIiwiZ2V0UG9zaXRpb24iLCJmaXRCb3VuZHMiXSwibWFwcGluZ3MiOiJBQUFBLGNBQ0EsV0FFSUEsRUFBRyxXQUVDQSxFQUFFQyxLQUFNRCxFQUFHLGVBQWlCLFdBRXhCLEdBQUlFLEdBQU9GLEVBQUdHLFNBSWxCSCxFQUFFQyxLQUFNRCxFQUFHLGFBQWUsV0FFdEIsR0FBSUksR0FBV0osRUFBRUcsVUFLekIsSUFBSUMs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V0FFUjNHLEVBQUVtSCxRQUFRLDJCQUE2QixTQUFVQyxHQUU3Q1gsRUFBUVcsRUFDUkosT0FBT0MsS0FBS0ksTUFBTUMsZUFBZXpHLE9BQVEsT0FBUStGLE1BSXpEeEUsRUFBWSxhQUlaOEUsRUFBYyxTQUFXSyxHQUVyQixJQUFLLEdBQUlDLEdBQUcsRUFBR0EsRUFBSWYsRUFBZ0IsT0FBRWdCLE9BQVFELElBRXpDRSxFQUFZRixFQUFHRCxJQUd2QkcsRUFBYSxTQUFXQyxFQUFHSixHQUV2QjdGLFdBQVcsV0FFUCxHQUFJdUIsR0FBVXdELEVBQWdCLE9BQUVrQixHQUM1QkMsRUFBWSxHQUFJWixRQUFPQyxLQUFLWSxPQUFRNUUsRUFBZSxJQUFHQSxFQUFlLEtBQ3JFNkUsRUFBUyxHQUFJZCxRQUFPQyxLQUFLYyxZQUU3QnZCLEdBQVVtQixHQUFNLEdBQUlYLFFBQU9DLEtBQUtlLFFBQzVCQyxTQUFVTCxFQUNWTCxJQUFLQSxFQUNMVyxXQUFXLEVBQ1hDLE1BQ0loRSxJQUFLbEIsRUFBZ0IsS0FDckJtRixXQUFZLEdBQUlwQixRQUFPQyxLQUFLb0IsS0FBTXBGLEVBQWdCLEtBQUcsR0FBS0EsRUFBZ0IsS0FBRyxLQUVqRnFGLFVBQVd0QixPQUFPQyxLQUFLc0IsVUFBVUMsTUFJckMsS0FBTSxHQUFJaEIsR0FBSSxFQUFHQSxFQUFJaEIsRUFBU2lCLE9BQVFELElBRVgsS0FBbEJoQixFQUFVZ0IsSUFDWE0sRUFBT1csT0FBUWpDLEVBQVVnQixHQUFJa0IsY0FJckNuQyxHQUFLb0MsVUFBV2IsSUFFYixJQUFKSCxHQUlYakIiLCJmaWxlIjoiY29udGFjdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbiggZnVuY3Rpb24oKSB7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoICcuc2l0ZV9fbWVudScgKSwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIG5ldyBNZW51ICggJCggdGhpcyApICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCggJy5sYW5ndWFnZScgKSwgZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgbmV3IExhbmd1YWdlICggJCh0aGlzKSApXG5cbiAgICAgICAgfSApO1xuICAgIH0pO1xuXG4gICAgdmFyIExhbmd1YWdlID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2xhbmd1YWdlc0Ryb3BEb3duID0gJCggJy5sYW5ndWFnZV9fZHJvcGRvd24nICksXG4gICAgICAgICAgICBfbGFuZ3VhZ2VzSXRlbSA9ICQoICcubGFuZ3VhZ2VfX2l0ZW0nICksXG4gICAgICAgICAgICBfbGFuZ3VhZ2VzRHJvcERvd25TcGVlZCA9IDIwMCxcbiAgICAgICAgICAgIF9tb3VzZWVudGVyVGltZW91dCxcbiAgICAgICAgICAgIF9tb3VzZWxlYXZlVGltZW91dCxcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKCB3aW5kb3cgKTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF9sYW5ndWFnZXNJdGVtLm9uKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICggZSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoICQoIHRoaXMgKS5wYXJlbnQoKS5oYXNDbGFzcyggJ2xhbmd1YWdlX19hY3RpdmUnICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLnRyaWdnZXIoJ21vdXNlZW50ZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkKCB0aGlzICkucGFyZW50KCkuaGFzQ2xhc3MoICdsYW5ndWFnZV9fZHJvcGRvd24nICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCAnLmxhbmd1YWdlX19hY3RpdmUgLmxhbmd1YWdlX19pdGVtJyApLmFwcGVuZFRvKCBfbGFuZ3VhZ2VzRHJvcERvd24gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIHRoaXMgKS5hcHBlbmRUbyggJy5sYW5ndWFnZV9fYWN0aXZlJyApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xhbmd1YWdlc0Ryb3BEb3duLnN0b3AoIHRydWUsIHRydWUgKS5zbGlkZVVwKCBfbGFuZ3VhZ2VzRHJvcERvd25TcGVlZCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLm9uKHtcbiAgICAgICAgICAgICAgICAgICAgbW91c2VlbnRlcjogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoIF9tb3VzZWxlYXZlVGltZW91dCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbW91c2VlbnRlclRpbWVvdXQgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sYW5ndWFnZXNEcm9wRG93bi5zdG9wKCB0cnVlLCB0cnVlICkuc2xpZGVEb3duKCBfbGFuZ3VhZ2VzRHJvcERvd25TcGVlZCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLm9uKHtcbiAgICAgICAgICAgICAgICAgICAgbW91c2VsZWF2ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoIF9tb3VzZWVudGVyVGltZW91dCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbW91c2VsZWF2ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKF9sYW5ndWFnZXNEcm9wRG93bi5pcyggJzp2aXNpYmxlJyApICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sYW5ndWFnZXNEcm9wRG93bi5zdG9wKCB0cnVlLCB0cnVlICkuc2xpZGVVcCggX2xhbmd1YWdlc0Ryb3BEb3duU3BlZWQgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcblxuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxuICAgIHZhciBNZW51ID0gZnVuY3Rpb24oIG9iaiApIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX21lbnUgPSBvYmosXG4gICAgICAgICAgICBfYm9keSA9ICQoICdib2R5JyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX3Nob3dCdG4gPSAkKCAnLnNpdGVfX21lbnUtYnRuJyApO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfb25FdmVudHMgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIF9zaG93QnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX29wZW5NZW51KCAkKCB0aGlzICkgKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc2V0U3R5bGUoKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1Njcm9sbCA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3aW5kb3dTY3JvbGwgPSBfd2luZG93LnNjcm9sbFRvcCgpLFxuICAgICAgICAgICAgICAgICAgICBoZXJvSGVpZ2h0ID0gJCgnLnNpdGVfX2hlcm8nKS5pbm5lckhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCB3aW5kb3dTY3JvbGwgPiBoZXJvSGVpZ2h0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggIV9zaG93QnRuLmhhc0NsYXNzKCAnYWN0aXZlJyApICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfc2hvd0J0bi5hZGRDbGFzcygnYWN0aXZlJylcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIF9zaG93QnRuLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX29wZW5NZW51ID0gZnVuY3Rpb24oIGVsZW0gKSAge1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSBlbGVtO1xuXG4gICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uaGFzQ2xhc3MoICdvcGVuZWQnICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5yZW1vdmVDbGFzcyggJ29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgX21lbnUucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgX2JvZHkuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAndmlzaWJsZSdcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBjdXJJdGVtLmFkZENsYXNzKCAnb3BlbmVkJyApO1xuICAgICAgICAgICAgICAgICAgICBfbWVudS5hZGRDbGFzcyggJ29wZW5lZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICBfYm9keS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdyc6ICdoaWRkZW4nXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfcmVzZXRTdHlsZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgX3Nob3dCdG4ucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgX21lbnUucmVtb3ZlQXR0ciggJ3N0eWxlJyApO1xuICAgICAgICAgICAgICAgIF9ib2R5LmNzcygge1xuICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAndmlzaWJsZSdcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF9tZW51WyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX29uRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7XG4iLCIoIGZ1bmN0aW9uKCl7XG5cbiAgICAkKCBmdW5jdGlvbigpe1xuXG4gICAgICAgICQoICcucG9wdXAnICkuZWFjaChmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICBuZXcgUG9wdXAoJCh0aGlzKSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIHZhciBQb3B1cCA9IGZ1bmN0aW9uKCBvYmogKXtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX3BvcHVwUGFkZGluZyA9IDQwLFxuICAgICAgICAgICAgX2J0blNob3cgPSAgJCggJy5wb3B1cF9fb3BlbicgKSxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfYnRuQ2xvc2UgPSBfb2JqLmZpbmQoICcucG9wdXBfX2Nsb3NlLCAucG9wdXBfX2NhbmNlbCcgKSxcbiAgICAgICAgICAgIF93cmFwID0gX29iai5maW5kKCAnLnBvcHVwX193cmFwJyApLFxuICAgICAgICAgICAgX2NvbnRlbnRzID0gX29iai5maW5kKCAnLnBvcHVwX19jb250ZW50JyApLFxuICAgICAgICAgICAgX3Njcm9sbENvbnRlaW5lciA9ICQoICdodG1sJyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX3ZpZGVvUG9wdXAgPSAkKCAnLnBvcHVwX192aWRlbycgKSxcbiAgICAgICAgICAgIF90aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7fSwgMSApO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfY2VudGVyV3JhcCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKCBfd2luZG93LmhlaWdodCgpIC0gKCBfcG9wdXBQYWRkaW5nICogMiApIC0gX3dyYXAuaGVpZ2h0KCkgPiAwICkge1xuICAgICAgICAgICAgICAgICAgICBfd3JhcC5jc3MoIHsgdG9wOiAoICggX3dpbmRvdy5oZWlnaHQoKSAtICggX3BvcHVwUGFkZGluZyAqIDIgKSApIC0gX3dyYXAuaGVpZ2h0KCkgKSAvIDIgfSApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF93cmFwLmNzcyggeyB0b3A6IDAgfSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfYWRkVmlkZW9GcmFtZSA9IGZ1bmN0aW9uICggdXJsICkge1xuXG4gICAgICAgICAgICAgICAgX3ZpZGVvUG9wdXAuYXBwZW5kKCAnPGlmcmFtZSBzcmM9XCInK3VybCsnP2F1dG9wbGF5PTFcIiBmcmFtZWJvcmRlcj1cIjBcIiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+JyApXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfZ2V0U2Nyb2xsV2lkdGggPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicpLFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxCYXJXaWR0aDtcblxuICAgICAgICAgICAgICAgIHNjcm9sbERpdi5jbGFzc05hbWUgPSAncG9wdXBfX3Njcm9sbGJhci1tZWFzdXJlJztcblxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIHNjcm9sbERpdiApO1xuXG4gICAgICAgICAgICAgICAgc2Nyb2xsQmFyV2lkdGggPSBzY3JvbGxEaXYub2Zmc2V0V2lkdGggLSBzY3JvbGxEaXYuY2xpZW50V2lkdGg7XG5cbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKCBzY3JvbGxEaXYgKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBzY3JvbGxCYXJXaWR0aDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaGlkZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29iai5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnaGlkZGVuJ1xuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiAwXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3BvcHVwX29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCAncG9wdXBfaGlkZScgKTtcblxuICAgICAgICAgICAgICAgIF90aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5jc3MgKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2F1dG8nXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdwb3B1cF9oaWRlJyApO1xuICAgICAgICAgICAgICAgIH0sIDMwMCApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCBfY29udGVudHMuaGFzQ2xhc3MoJ3BvcHVwX192aWRlbycpICkge1xuXG4gICAgICAgICAgICAgICAgICAgIF92aWRlb1BvcHVwLmZpbmQoJ2lmcmFtZScpLnJlbW92ZSgpXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29ialsgMCBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2VudGVyV3JhcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9idG5TaG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3coICQoIHRoaXMgKS5hdHRyKCAnZGF0YS1wb3B1cCcgKSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoICQoIHRoaXMgKS5hdHRyKCAnZGF0YS1wb3B1cCcpID09ICd2aWRlbycgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWRkVmlkZW9GcmFtZSggJCggdGhpcyApLmF0dHIoICdkYXRhLXZpZGVvJyApIClcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkKCB0aGlzICkuYXR0ciggJ2RhdGEtcG9wdXAnKSA9PSAnYm9vaycgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggJy5wb3B1cF9fYm9vayAuYm9va2luZycgKVswXS5saXN0LmluaXRTd2lwZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCAnLmF1dG9jb21wbGV0ZScgKVswXS5vYmouaW5pdEF1dG9jb21wbGl0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX2NvbnRlbnRzLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiggZSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfb2JqLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX2hpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfYnRuQ2xvc2Uub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zaG93ID0gZnVuY3Rpb24oIGNsYXNzTmFtZSApe1xuXG4gICAgICAgICAgICAgICAgX3NldFBvcHVwQ29udGVudCggY2xhc3NOYW1lICk7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjbGFzc05hbWUpO1xuXG5cblxuICAgICAgICAgICAgICAgIF9zY3JvbGxDb250ZWluZXIuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2hpZGRlbicsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogX2dldFNjcm9sbFdpZHRoKClcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCAncG9wdXBfb3BlbmVkJyApO1xuXG4gICAgICAgICAgICAgICAgX2NlbnRlcldyYXAoKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRQb3B1cENvbnRlbnQgPSBmdW5jdGlvbiggY2xhc3NOYW1lICl7XG4gICAgICAgICAgICAgICAgdmFyIGN1ckNvbnRlbnQgPSBfY29udGVudHMuZmlsdGVyKCAnLnBvcHVwX18nICsgY2xhc3NOYW1lICk7XG5cbiAgICAgICAgICAgICAgICBfY29udGVudHMuY3NzKCB7IGRpc3BsYXk6ICdub25lJyB9ICk7XG4gICAgICAgICAgICAgICAgY3VyQ29udGVudC5jc3MoIHsgZGlzcGxheTogJ2Jsb2NrJyB9ICk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXG5cblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG59ICkoKTtcblxuIiwiXG4oIGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgJCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJC5lYWNoKCAkKCAnLnNsaWRlcycgKSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBuZXcgU2xpZGVzICggJCggdGhpcyApICk7XG4gICAgICAgIH0gKTtcblxuICAgIH0pO1xuXG4gICAgdmFyIFNsaWRlcyA9IGZ1bmN0aW9uICggb2JqICkge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfb25FdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbih7XG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoZWNrU2Nyb2xsID0gZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgIHZhciB3aW5kb3dIID0gX3dpbmRvdy5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIF9vYmouZWFjaChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wUG9zID0gX29iai5vZmZzZXQoKS50b3A7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cuc2Nyb2xsVG9wKCkgPiAodG9wUG9zIC0gd2luZG93SC8xLjMpICYmICFjdXJJdGVtLmhhc0NsYXNzKCAnYW5pbWF0aW9uJyApICl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0uYWRkQ2xhc3MoICdhbmltYXRpb24nICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX29ialswXS5zbGlkZXMgPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfb25FdmVudHMoKTtcbiAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbn0gKSgpO1xuXG5cblxuXG4iLCJcbiggZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoICcuY29udGFjdF9fbWFwJyApLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgbmV3IE1hcCAoICQoIHRoaXMgKSApO1xuXG4gICAgICAgIH0gKTtcbiAgICB9KTtcblxuICAgIHZhciBNYXAgPSBmdW5jdGlvbiAoIG9iaiApIHtcblxuICAgICAgICB0aGlzLm9iaiA9IG9iajtcbiAgICAgICAgdGhpcy5tYXBXcmFwID0gdGhpcy5vYmo7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9tYXAsXG4gICAgICAgICAgICBfbWFya2VycyA9IFtdLFxuICAgICAgICAgICAgX2RhdGEgPSBudWxsO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfY29uc3RydWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX2xvYWREYXRhKCk7XG4gICAgICAgICAgICAgICAgX29uRXZlbnRzKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXRNYXAgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgem9vbTogX2RhdGFbICd6b29tJyBdLFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2VcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgX21hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoIF9zZWxmLm1hcFdyYXBbMF0sIG1hcE9wdGlvbnMgKTtcbiAgICAgICAgICAgICAgICBfc2V0TWFya2VycyggX21hcCApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2xvYWREYXRhID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgJC5nZXRKU09OKCdqc29uL2NvbnRhY3QtbWFwLmpzb24nLCB7fSwgZnVuY3Rpb24oIGRhdGEgKXtcblxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZERvbUxpc3RlbmVyKHdpbmRvdywgJ2xvYWQnLCBfaW5pdE1hcCk7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfb25FdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRNYXJrZXJzID0gZnVuY3Rpb24gKCBtYXAgKSB7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0wOyBqIDwgX2RhdGFbICdwbGFjZXMnIF0ubGVuZ3RoOyBqKyspIHtcblxuICAgICAgICAgICAgICAgICAgICBfYWRkTWFya2VyKCBqLCBtYXAgKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfYWRkTWFya2VyID0gZnVuY3Rpb24gKCBpLCBtYXAgKSB7XG5cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gX2RhdGFbICdwbGFjZXMnIF1baV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJMYXRMbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCBjdXJJdGVtWyAnbGF0JyBdLCBjdXJJdGVtWyAnbG5nJyBdICksXG4gICAgICAgICAgICAgICAgICAgICAgICBib3VuZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nQm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgX21hcmtlcnNbIGkgXSA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjdXJMYXRMbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBjdXJJdGVtWyAnaWNvbicgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSggY3VySXRlbVsgJ3NpemUnIF1bIDAgXSwgY3VySXRlbVsgJ3NpemUnIF1bIDEgXSApXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUFxuXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKCB2YXIgaiA9IDA7IGogPCBfbWFya2Vycy5sZW5ndGg7IGorKyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBfbWFya2Vyc1sgaiBdICE9PSAnJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3VuZHMuZXh0ZW5kKCBfbWFya2Vyc1sgaiBdLmdldFBvc2l0aW9uKCkgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF9tYXAuZml0Qm91bmRzKCBib3VuZHMgKTtcblxuICAgICAgICAgICAgICAgIH0sIGkgKiAzMDApO1xuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9jb25zdHJ1Y3RvcigpO1xuICAgIH07XG5cbn0gKSgpO1xuIl19
